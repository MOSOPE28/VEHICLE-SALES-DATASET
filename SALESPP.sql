COPY "SALESPP"
FROM 'C:\Program Files\PostgreSQL\16\data\SAMPLE DATA\SALESPP.csv'CSV HEADER;

SELECT *
FROM "SALESPP"
---- what product line had the highest sales?
SELECT 
     Product_line
	 SUM (sales)
FROM "SALESPP"
GROUP BY 
     Product_line
	 
-----What is the total sales revenue generated by each order number?
SELECT 
    order_number, 
    SUM(sales) AS total_sales_revenue
FROM 
    "SALESPP"
GROUP BY 
    order_number;

----What is the average sales value per order?
SELECT 
    AVG(total_sales) AS average_sales_value_per_order
FROM (
    SELECT 
        order_number, 
        SUM(sales) AS total_sales
    FROM 
        "SALESPP"
    GROUP BY 
        order_number
) AS order_totals;

----What is the total quantity ordered in each order?
SELECT 
    order_number, 
    SUM(quantity_ordered) AS total_quantity_ordered
FROM 
    "SALESPP"
GROUP BY 
    order_number;

---Which product codes generate the highest total sales?
SELECT 
    product_code, 
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    product_code
ORDER BY 
    total_sales DESC;

----What is the average price each for different product codes?
SELECT 
    product_code, 
    AVG(price_each) AS average_price_each
FROM 
    "SALESPP"
GROUP BY 
    product_code;
	
----What is the average quantity ordered for each product code?
SELECT 
    product_code, 
    AVG(quantity_ordered) AS average_quantity_ordered
FROM 
    "SALESPP"
GROUP BY 
    product_code;

----Which customers contribute the most to total sales?
SELECT 
    customer_name, 
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    customer_name
ORDER BY 
    total_sales DESC;

-----What is the average order value for each customer?
SELECT 
    customer_name, 
    AVG(total_order_value) AS average_order_value
FROM (
    SELECT 
        customer_name, 
        order_number, 
        SUM(sales) AS total_order_value
    FROM 
        "SALESPP"
    GROUP BY 
        customer_name, 
        order_number
) AS customer_orders
GROUP BY 
    customer_name;

----How many orders has each customer placed?
SELECT 
    customer_name, 
    COUNT(DISTINCT order_number) AS number_of_orders
FROM 
    "SALESPP"
GROUP BY 
    customer_name;

-----Which cities generate the highest total sales revenue?
SELECT 
    city, 
    SUM(sales) AS total_sales_revenue
FROM 
    "SALESPP"
GROUP BY 
    city
ORDER BY 
    total_sales_revenue DESC;
	
-----How do sales compare between different countries?
SELECT 
    country, 
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    country
ORDER BY 
    total_sales DESC;

-----What is the total sales revenue from each territory?
SELECT 
    territory, 
    SUM(sales) AS total_sales_revenue
FROM 
    "SALESPP"
GROUP BY 
    territory;
	
----What are the total sales for each quarter (qtr_id)?
SELECT 
    qtr_id,
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    qtr_id;

----How do sales trends vary across different quarters?
SELECT
    QTR_ID,
    SUM(SALES) AS total_sales
FROM
    "SALESPP"
GROUP BY
    QTR_ID
ORDER BY
    QTR_ID;

----What are the most common deal sizes in the dataset
SELECT
    deal_size,
    COUNT(*) AS frequency
FROM
    "SALESPP"
GROUP BY
    deal_size
ORDER BY
    frequency DESC
LIMIT 5;

-----What is the average sales revenue for each deal size category?
SELECT
    deal_size,
    AVG(sales) AS average_sales_revenue
FROM
    "SALESPP"
GROUP BY
    deal_size
ORDER BY
    deal_size;

----What is the average sales revenue per orderline number?
SELECT
    orderline_number,
    AVG(sales_revenue) AS average_sales_revenue
FROM
    sales_data
GROUP BY
    orderline_number
ORDER BY
    orderline_number;

----How does the quantity ordered vary by orderline number?
SELECT
    orderline_number,
    SUM(quantity_ordered) AS total_quantity_ordered
FROM
    "SALESPP"
GROUP BY
    orderline_number
ORDER BY
    orderline_number;

----Which combinations of product codes and customer names generate the most revenue?
SELECT
    product_code,
    customer_name,
    SUM(price_each * quantity_ordered) AS total_revenue
FROM
    "SALESPP"
GROUP BY
    product_code,
    customer_name
ORDER BY
    total_revenue DESC
LIMIT 10;

-----How do sales metrics (quantity ordered, sales, etc.) compare across different territories?
SELECT
    territory,
    SUM(quantity_ordered) AS total_quantity_ordered,
    SUM(sales) AS total_sales_amount,
    AVG(price_each) AS average_price_per_item,
    COUNT(*) AS total_orders
FROM
    "SALESPP"
GROUP BY
    territory
ORDER BY
    total_sales_amount DESC;

-----How does the price each impact the quantity ordered for different products?
SELECT
    product_code,
    AVG(price_each) AS average_price_each,
    AVG(quantity_ordered) AS average_quantity_ordered
FROM
    "SALESPP"
GROUP BY
    product_code
ORDER BY
    average_price_each DESC;

---What are the total sales for each quater_id
SELECT 
    qtr_id, 
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    qtr_id;

----How do sales trends vary across different quarters?
SELECT 
    qtr_id, 
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    qtr_id
ORDER BY 
    qtr_id;
	
----How does the deal size correlate with total sales revenue?
SELECT 
    deal_size, 
    SUM(sales) AS total_sales
FROM 
    "SALESPP"
GROUP BY 
    deal_size
ORDER BY 
    total_sales DESC;


